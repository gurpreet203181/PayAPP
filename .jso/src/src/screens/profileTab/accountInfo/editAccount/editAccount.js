var t=r(d[0]);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=t(r(d[1])),o=t(r(d[2])),l=t(r(d[3])),u=(function(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var o=v(n);if(o&&o.has(t))return o.get(t);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var c=u?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(l,s,c):l[s]=t[s]}l.default=t,o&&o.set(t,l);return l})(r(d[4])),s=r(d[5]),c=r(d[6]),p=r(d[7]),f=r(d[8]),b=t(r(d[9])),h=r(d[10]),O=r(d[11]),y=r(d[12]),S=r(d[13]);function v(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,o=new WeakMap;return(v=function(t){return t?o:n})(t)}function N(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);n&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,l)}return o}function w(t){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?N(Object(l),!0).forEach(function(n){(0,o.default)(t,n,l[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):N(Object(l)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(l,n))})}return t}var x=c.StyleSheet.create({inputLabel:w(w({},p.FONTS.h5),{},{fontSize:14,marginTop:24,color:p.COLORS.lightGray3}),inputConatainer:w(w({width:327,borderRadius:16,backgroundColor:p.COLORS.white3,marginTop:12,marginLeft:0,padding:16,width:"100%"},p.FONTS.body2),{},{fontSize:14,color:p.COLORS.darkBlue3}),editButton:{marginTop:34,height:56,width:327,borderRadius:16,backgroundColor:p.COLORS.darkBlue3,marginBottom:20,alignSelf:"center"},editButtonLabel:w(w({color:p.COLORS.white},p.FONTS.h5),{},{fontSize:15}),erroMsg:w({paddingTop:20,textAlign:"center",color:p.COLORS.red},p.FONTS.body5)}),C=function(t){var o,v=t.navigation,N=t.route,C=null==N?void 0:null==(o=N.params)?void 0:o.user,j=(0,u.useState)(!1),L=(0,l.default)(j,2),P=L[0],T=L[1],k=(0,u.useState)({firstName:"",lastName:"",username:"",phoneNumber:"",email:"",ewalletId:""}),R=(0,l.default)(k,2),B=R[0],I=R[1],F=(0,u.useState)(),z=(0,l.default)(F,2),D=z[0],_=z[1],M=(0,u.useRef)(),V=(0,u.useState)(!1),A=(0,l.default)(V,2);A[0],A[1];(0,u.useEffect)(function(){console.log("editAccount"+(null==C?void 0:C.ewalletId)),I({firstName:null==C?void 0:C.firstName,lastName:null==C?void 0:C.lastName,username:null==C?void 0:C.username,phoneNumber:null==C?void 0:C.phoneNumber,email:null==C?void 0:C.email,ewalletId:null==C?void 0:C.ewalletId})},[]);return(0,S.jsxs)(c.View,{style:{flex:1,backgroundColor:p.COLORS.white},children:[(0,S.jsx)(f.Header,{title:(0,s.t)("editAccount"),rightIcon:p.icons.close,onRightIconPress:function(){return v.goBack()}}),D&&(0,S.jsx)(c.View,{style:w(w({},p.SIZES.marginHorizontal),{},{marginTop:12}),children:(0,S.jsx)(c.Text,{style:x.erroMsg,children:D})}),(0,S.jsx)(c.ScrollView,{style:{marginTop:20},showsHorizontalScrollIndicator:!1,children:(0,S.jsxs)(c.View,{style:w({},p.SIZES.marginHorizontal),children:[(0,S.jsx)(c.Text,{style:x.inputLabel,children:(0,s.t)("firstName")}),(0,S.jsx)(f.FormInput,{textContainerStyle:{borderBottomColor:p.COLORS.white},inputStyle:x.inputConatainer,autoCapitalize:"words",value:B.firstName,onChange:function(t){return I(w(w({},B),{},{firstName:t}))}}),(0,S.jsx)(c.Text,{style:x.inputLabel,children:(0,s.t)("lastName")}),(0,S.jsx)(f.FormInput,{textContainerStyle:{borderBottomColor:p.COLORS.white},inputStyle:x.inputConatainer,autoCapitalize:"words",value:B.lastName,onChange:function(t){return I(w(w({},B),{},{lastName:t}))}}),(0,S.jsx)(c.Text,{style:x.inputLabel,children:(0,s.t)("username")}),(0,S.jsx)(f.FormInput,{textContainerStyle:{borderBottomColor:p.COLORS.white},inputStyle:x.inputConatainer,autoCapitalize:"words",value:B.username,onChange:function(t){return I(w(w({},B),{},{username:t}))}}),(0,S.jsx)(c.Text,{style:x.inputLabel,children:(0,s.t)("phoneNumber")}),(0,S.jsx)(b.default,{ref:M,value:null==B?void 0:B.phoneNumber,defaultCode:"IT",layout:"first",placeholder:" ",onChangeText:function(){return _()},onChangeFormattedText:function(t){I(w(w({},B),{},{phoneNumber:t}))},countryPickerProps:{withAlphaFilter:!0},containerStyle:{marginTop:12},textContainerStyle:[x.inputConatainer,{marginTop:0}]}),(0,S.jsx)(f.Button,{containerStyle:x.editButton,labelStyle:x.editButtonLabel,label:(0,s.t)("save"),onPress:function(){var t;n.default.async(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,t=h.firebaseAuth.currentUser,!y.utils.editAccountValidateCredentials(B,_)){o.next=15;break}if(T(!0),null!=C&&C.phoneNumberVerified&&!B.phoneNumber!=(null==C?void 0:C.phoneNumber)){o.next=12;break}return o.next=7,n.default.awrap(h.firestoreDb.collection("users").doc(null==t?void 0:t.uid).update({firstName:B.firstName,lastName:B.lastName,username:B.username}));case 7:return h.cloudFunction.httpsCallable("walletObject-update_Personal_Wallet")({value:B}),o.next=10,n.default.awrap(h.cloudFunction.httpsCallable("isPhoneNumberLinked")({phoneNumber:B.phoneNumber}).then(function(t){0==t.data?(0,O.sendSmsVerification)(B.phoneNumber).then(function(t){t.success?(T(!1),v.navigate("Otp",{phoneNumber:B.phoneNumber,user:C})):_((0,s.t)("invaildNumber"))}):(_((0,s.t)("phoneNumberLinked")),T(!1))}).catch(function(t){console.log(t),_(t)}));case 10:o.next=15;break;case 12:return o.next=14,n.default.awrap(h.firestoreDb.collection("users").doc(null==t?void 0:t.uid).update({firstName:B.firstName,lastName:B.lastName,username:B.username}));case 14:v.goBack();case 15:o.next=21;break;case 17:o.prev=17,o.t0=o.catch(0),console.log(o.t0),T(!1);case 21:case"end":return o.stop()}},null,null,[[0,17]],Promise)}})]})}),P&&(0,S.jsx)(f.Loading,{})]})};e.default=C